name: Github Pages

on:
  push:
    branches:
      - master  # 브랜치명이 main이면 main으로 변경해야 함

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write # 배포를 위해 쓰기 권한 추가
    steps:
      - uses: actions/checkout@v4

      # 의존성 캐싱 (빌드 속도 향상)
      - uses: actions/cache@v4
        with:
          path: vendor/bundle
          key: ${{ runner.os }}-gems-${{ hashFiles('**/Gemfile.lock') }}
          restore-keys: |
            ${{ runner.os }}-gems-

      # Jekyll 배포 액션 실행
      - uses: jeffreytse/jekyll-deploy-action@v0.6.0
        with:
          provider: 'github'
          token: ${{ secrets.GITHUB_TOKEN }} 
          repository: ''             
          branch: 'gh-pages'         
          jekyll_src: './'           
          jekyll_cfg: '_config.yml'  
          
          # [중요 수정 1] 데모용 URL 제거 (빈칸으로 두면 자동 설정됨)
          jekyll_baseurl: ''         
          
          # [중요 수정 2] Sass 오류 해결을 위해 Ruby 3.3 버전 강제 지정
          ruby_version: '3.3'
          
          cname: ''                  
          actor: ''